'''
Created on Mar 11, 2018

@author: pratik
'''


from pyspark import SparkContext
from pyspark.streaming import StreamingContext
from pyspark.streaming.kafka import KafkaUtils

sc = SparkContext(appName="PythonSparkStreamingKafka")
sc.setLogLevel("WARN")
ssc = StreamingContext(sc,60)

"""
kafkaStream = KafkaUtils.createStream(streamingContext, \
    [ZK quorum], [consumer group id], [per-topic number of Kafka partitions to consume])
"""

kafkaStream = KafkaUtils.createStream(ssc, 'victoria.com:2181', 'spark-streaming', {'imagetext':1})
lines = kafkaStream.map(lambda x: x[1])
lines.pprint()